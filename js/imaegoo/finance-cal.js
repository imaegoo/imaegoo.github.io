function PMT(){}PMT.prototype.pmt=function(e,t,n,i,r){return i=i||0,r=r||0,0==e?-(n+i)/t:(n=e/((t=Math.pow(1+e,t))-1)*-(n*t+i),1==r&&(n/=1+e),n.toFixed(4))},PMT.prototype.nper=function(e,t,n,i,r){if(n=n||0,0==e)return-(t+n)/i;1===(r=r||0)&&(i*=1+e);r=Math.log((i-e*n)/(i+e*t))/Math.log(1+e);return Math.ceil(r)},PMT.prototype.pv=function(e,t,n,i,r){if(n=n||0,0===e)return-i*t-n;1===(r=r||0)&&(i*=1+e);r=Math.pow(1+e,t);return((-i*(r-1)/e-n)/r).toFixed(4)},PMT.prototype.fv=function(e,t,n,i,r){if(0===e)return-i*t-n;1===(r=r||0)&&(i*=1+e);r=Math.pow(1+e,t);return(-i*(r-1)/e-n*r).toFixed(4)};var query=function(e){return document.querySelector(e)},queryAll=function(e){return document.querySelectorAll(e)};function disableParam(){query('[name="param"]:not(:checked)').disabled=!0}function setInputFilter(t,n){["input","keydown","keyup","mousedown","mouseup","select","contextmenu","drop"].forEach(function(e){t.addEventListener(e,function(){n(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")?(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd)):this.value=""})})}var pmtCalculator=new PMT,params=["nper","pv","fv","pmt"],todo=[];function calculate(){var e=queryAll('[name="param"]:checked');if(3===e.length){var t=query('[name="type"]:checked');if(t){var n=Number(query('[name="rate"]').value)/100,r=Number(t.value),l=[],a=[];let i=!1;if(e.forEach(function(e){var t=query(`[name="${e.value}"]`),n=(t.classList.remove("invalid-tip"),t.value),t=(""===n&&(i=!0,t.classList.add("invalid-tip")),query('[name="rate"]'));""===t.value&&(i=!0,t.classList.add("invalid-tip")),l.push(e.value),a.push(Number(n))}),!i)for(var u=0;u<params.length;u++){var o=params[u];if(-1===l.indexOf(params[u])){o=pmtCalculator[o](n,a[0],a[1],a[2],r);query(".result").innerHTML=o,query(".result").style.color="#333";break}}}}}function clearResult(){window.location.reload()}window.onload=function(){document.getElementById("calculate").addEventListener("click",calculate),document.getElementById("\bclear-result").addEventListener("click",clearResult);var n=queryAll("input.input-param"),i=queryAll("input[name=param]");for(let e=0,t=i.length;e<t;e++)i[e].addEventListener("click",function(){document.querySelector("input.input-param[name="+i[e].id+"]").classList.remove("invalid-tip")});for(let e=0,t=n.length;e<t;e++){const u=n[e];u.addEventListener("focus",function(){u.classList.remove("invalid-tip")}),u.nextElementSibling.addEventListener("click",function(){u.classList.remove("invalid-tip")})}Array.prototype.forEach.call(queryAll('[name="param"]'),function(e){e.addEventListener("click",function(e){var t=this.value,n=query(`[name="${t}"`);this.checked?(todo.push(t),n.disabled=!1,3===todo.length&&(query('[name="param"]:not(:checked)').disabled=!0)):(t=todo.indexOf(t),todo.splice(t,1),n.disabled=!0,n.value="",2===todo.length&&(query('[name="param"]:disabled').disabled=!1,query(".result").style.color="#9e9e9e"))})}),Array.prototype.forEach.call(queryAll(".input-param"),function(e){setInputFilter(e,function(e){return/^-?\d*\.?\d*$/.test(e)}),e.addEventListener("blur",function(){-1<[".","-","-."].indexOf(this.value)&&(this.value="")})});var r=document.querySelectorAll(".close");for(let e=0,t=r.length;e<t;e++){var l=r[e];l.removeEventListener("click",a),l.addEventListener("click",a)}function a(){window.parent.postMessage("close","*")}!function(){"use strict";var t,n,i,r,l,a,u,o,c,s,d=document.querySelector("#history"),p=query(".sub-calc");function f(e){t=null,n=e.currNum,r=e.prevBtn,a=l=null,u=0,i=e.history,c=!(o=!1)}function v(e){e=String(e),s.value=e}function m(e){d.value=e}function y(e){t=Number(new BigNumber(t).plus(e).toFixed(4))}function h(e){t=Number(new BigNumber(t).minus(e).toFixed(4))}function b(e){t=Number(new BigNumber(t).dividedBy(e).toFixed(4))}function N(e){t=Number(new BigNumber(t).times(e).toFixed(4))}Array.prototype.forEach.call(queryAll(".mini-calc"),function(t){t.addEventListener("click",function(e){e.stopPropagation(),t.previousElementSibling.disabled||(f({currNum:(s=t.previousElementSibling).value,prevBtn:s.value,history:"0"===s.value?"":s.value}),p.style.display="inline-block",p.style.position="absolute",p.style.left=t.offsetLeft-p.offsetWidth+"px",p.style.top=t.offsetTop+20+"px",s.classList.add("focused"))})}),query(".pmt-calculator").addEventListener("click",function(e){p.style.display="none",Array.prototype.forEach.call(queryAll(".input-param"),function(e){e.classList.remove("focused")})}),query(".sub-calc").addEventListener("click",function(e){e.stopPropagation()}),Array.prototype.forEach.call(p.querySelectorAll(".button"),function(e){e.addEventListener("click",function(e){e=e.currentTarget.getAttribute("data-value");switch(isNaN(r)||"="===e||"C"===e||"CS"===e||"."===e||(a=l),e){case"+":o=!0,l=y;break;case"-":o=!0,l=h;break;case"/":o=!0,l=b;break;case"*":o=!0,l=N;break;case"C":f({currNum:"0",prevBtn:null,history:""}),v(0)}if(("C"===e||"Result is undefined"!==t)&&"Cannot divide by zero"!==t){if("="!==e&&"C"!==e&&"CS"!==e&&(i=isNaN(r)&&isNaN(e)?i.slice(0,-1)+e:i+e),isNaN(e)&&"."!==e){if("-"!==e&&"+"!==e&&"*"!==e&&"/"!==e||(null!==r&&"="!==r||c||(i="0"+e,u++),!d.value.length&&s.value.length&&(i=s.value+e)),l&&null===t&&(t=Number(n)),"%"===e?(i=i.slice(0,-(n.length+1)),n=function(e){return Number(new BigNumber(e).dividedBy(100).toFixed(4))}(n),i+=n+" ",v(n)):"sqrt"!==e&&"1/x"!==e&&"+/-"!==e||(i=i.slice(0,-(n.length+e.length))+("1/x"===e?"1/("+n+") ":"+/-"===e?"-1*("+n+") ":e+"("+n+") "),v(n="sqrt"===e?function(e){return Number(new BigNumber(e).sqrt().toFixed(4))}(s.value):"1/x"===e?function(e){return Number(new BigNumber(1).dividedBy(e).toFixed(4))}(s.value):-1*s.value),m(i)),"="===e&&l)return void(u=0,l(o?n:Number(n)),i="",r=e,v(t),m(i));if(!isNaN(e)||isNaN(r)&&"%"!==r&&"sqrt"!==r&&"1/x"!==r||"="===e||"C"===e||"CS"===e||"."===e||"%"===e||"sqrt"===e||"1/x"===e||u++,2<=u&&(!isNaN(r)||"sqrt"===r||"sqr"===r||"1/x"===r||"%"===r)&&"CS"!==e&&(a(Number(n)),i=(n=t)+e,u=1,v(t)),"CS"===e){if(t==s.value||-1!==["sqrt","%","1/x","+/-"].indexOf(r))return;n=n.slice(0,-1),i=i.slice(0,-1),v(n=n.length?n:"0")}null!==t&&"CS"!==e&&m(i)}else"."===e&&/^\d+$/.test(n)?n+=e:isNaN(e)||("="===r&&(t=null),n=!isNaN(r)&&null!==r&&"0"!==s.value||"."===r?n+e:e),o=!1,v(n);r=e,c=!1}})})}()};